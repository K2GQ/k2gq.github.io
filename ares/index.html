<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Viewport meta tag for responsive mobile behavior -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ARES® Registration Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      padding: 10px;
    }
    .container {
      background: #fff;
      max-width: 800px;
      margin: auto;
      padding: 20px;
      border: 1px solid #ccc;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    th, td {
      border: 1px solid #000;
      padding: 5px;
      font-size: 14px;
      text-align: center;
    }
    .header-table {
      border: none;
      margin-bottom: 25px;
    }
    .header-table td {
      border: none;
      text-align: center;
    }
    .header-table h1 {
      margin: 0;
      font-size: 20px;
    }
    .section-title {
      font-weight: bold;
      margin: 15px 0 5px;
      font-size: 16px;
      text-decoration: underline;
    }
    input[type="text"],
    input[type="date"],
    input[type="email"] {
      width: 100%;
      box-sizing: border-box;
      padding: 4px;
      font-size: 14px;
    }
    .signature-container {
      border: 1px solid #000;
      width: 100%;
      height: 150px;
      position: relative;
    }
    .radio-group {
      padding: 10px;
      white-space: nowrap; /* Keep Yes/No on one line */
    }
    .button {
      padding: 10px 15px;
      background-color: #007BFF;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
    }
    .button:hover {
      background-color: #0056b3;
    }
    .inline {
      display: inline-block;
      vertical-align: middle;
    }
    /* Signature & Date container: side-by-side on desktop, stacked on mobile */
    .signature-date-container {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      margin-bottom: 15px;
    }
    .date-container {
      width: 30%;
    }
    .signature-container-wrapper {
      width: 65%;
    }
    @media (max-width: 600px) {
      .container {
        padding: 10px;
      }
      th, td {
        font-size: 12px;
        padding: 3px;
      }
      .header-table h1 {
        font-size: 18px;
      }
      .button {
        font-size: 16px;
        padding: 12px 18px;
      }
      /* Stack date above signature on mobile */
      .signature-date-container {
        flex-direction: column;
      }
      .date-container, .signature-container-wrapper {
        width: 100%;
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container" id="form-container">
    <!-- Header Section -->
    <table class="header-table">
      <tr>
        <td><h1>ARES® Registration Form</h1></td>
      </tr>
      <tr>
        <td>Amateur Radio Emergency Service®</td>
      </tr>
    </table>

    <!-- Personal Information -->
    <table>
      <tr>
        <td style="width: 15%;">Name:</td>
        <td style="width: 35%;"><input type="text" id="name"></td>
        <td style="width: 15%;">Call Sign:</td>
        <td style="width: 35%;"><input type="text" id="call-sign"></td>
      </tr>
      <tr>
        <td>Mailing Address:</td>
        <td colspan="3"><input type="text" id="mailing-address"></td>
      </tr>
      <tr>
        <td>City:</td>
        <td><input type="text" id="city"></td>
        <td>State:</td>
        <td><input type="text" id="state"></td>
      </tr>
      <tr>
        <td>ZIP Code:</td>
        <td><input type="text" id="zip"></td>
        <td>Email Address(es):</td>
        <td><input type="text" id="email"></td>
      </tr>
      <tr>
        <td>Home Phone:</td>
        <td><input type="text" id="home-phone"></td>
        <td>Work Phone:</td>
        <td><input type="text" id="work-phone"></td>
      </tr>
      <tr>
        <td>Cell Phone:</td>
        <td><input type="text" id="cell-phone"></td>
        <td>License Class:</td>
        <td><input type="text" id="license-class"></td>
      </tr>
    </table>

    <!-- Bands and Modes Table -->
    <div class="section-title">Check bands and modes that you can operate:</div>
    <table>
      <tr>
        <th style="width: 20%;">Mode</th>
        <th style="width: 13%;">HF</th>
        <th style="width: 13%;">6 meters</th>
        <th style="width: 13%;">2 meters</th>
        <th style="width: 13%;">222 MHz</th>
        <th style="width: 13%;">440 MHz</th>
        <th style="width: 15%;">Others</th>
      </tr>
      <tr>
        <td>SSB</td>
        <td><input type="checkbox" name="ssb_hf"></td>
        <td><input type="checkbox" name="ssb_6"></td>
        <td><input type="checkbox" name="ssb_2"></td>
        <td><input type="checkbox" name="ssb_222"></td>
        <td><input type="checkbox" name="ssb_440"></td>
        <td><input type="checkbox" name="ssb_others"></td>
      </tr>
      <tr>
        <td>CW</td>
        <td><input type="checkbox" name="cw_hf"></td>
        <td><input type="checkbox" name="cw_6"></td>
        <td><input type="checkbox" name="cw_2"></td>
        <td><input type="checkbox" name="cw_222"></td>
        <td><input type="checkbox" name="cw_440"></td>
        <td><input type="checkbox" name="cw_others"></td>
      </tr>
      <tr>
        <td>FM</td>
        <td><input type="checkbox" name="fm_hf"></td>
        <td><input type="checkbox" name="fm_6"></td>
        <td><input type="checkbox" name="fm_2"></td>
        <td><input type="checkbox" name="fm_222"></td>
        <td><input type="checkbox" name="fm_440"></td>
        <td><input type="checkbox" name="fm_others"></td>
      </tr>
      <tr>
        <td>DATA</td>
        <td><input type="checkbox" name="data_hf"></td>
        <td><input type="checkbox" name="data_6"></td>
        <td><input type="checkbox" name="data_2"></td>
        <td><input type="checkbox" name="data_222"></td>
        <td><input type="checkbox" name="data_440"></td>
        <td><input type="checkbox" name="data_others"></td>
      </tr>
      <tr>
        <td>PACKET</td>
        <td><input type="checkbox" name="packet_hf"></td>
        <td><input type="checkbox" name="packet_6"></td>
        <td><input type="checkbox" name="packet_2"></td>
        <td><input type="checkbox" name="packet_222"></td>
        <td><input type="checkbox" name="packet_440"></td>
        <td><input type="checkbox" name="packet_others"></td>
      </tr>
      <tr>
        <td>Other modes<br>(specify below):</td>
        <td colspan="6"><input type="text" id="other-modes" style="width: 100%;"></td>
      </tr>
      <tr>
        <td>Mobile Operation</td>
        <td><input type="checkbox" name="mobile_hf"></td>
        <td><input type="checkbox" name="mobile_6"></td>
        <td><input type="checkbox" name="mobile_2"></td>
        <td><input type="checkbox" name="mobile_222"></td>
        <td><input type="checkbox" name="mobile_440"></td>
        <td><input type="checkbox" name="mobile_others"></td>
      </tr>
    </table>

    <!-- Home Station Power Question -->
    <div class="radio-group">
      Can your home station be operated without commercial power? 
      &nbsp;&nbsp;Yes <input type="radio" name="home_power" value="Yes">
      &nbsp;&nbsp;No <input type="radio" name="home_power" value="No">
    </div>

    <!-- Signature and Date Section -->
    <div class="signature-date-container">
      <div class="date-container">
        <label for="date"><strong>Date:</strong></label><br>
        <input type="date" id="date">
      </div>
      <div class="signature-container-wrapper">
        <label><strong>Signature:</strong></label><br>
        <div id="signature-pad" class="signature-container"></div>
        <button type="button" id="clear-signature" class="button inline">Clear</button>
      </div>
    </div>

    <!-- Action Button: "Download Zip" on desktop; "Share Form" on mobile -->
    <button type="button" id="action-button" class="button"></button>
  </div>

  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
  <script>
    // Detect if running on a mobile device
    function isMobile() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    // Create and initialize the signature pad
    const container = document.getElementById('signature-pad');
    const sigCanvas = document.createElement('canvas');
    sigCanvas.style.width = '100%';
    sigCanvas.style.height = '100%';
    container.appendChild(sigCanvas);
    const signaturePad = new SignaturePad(sigCanvas);

    // Resize the signature canvas for high-DPI devices
    function resizeCanvas() {
      const ratio = Math.max(window.devicePixelRatio || 1, 1);
      sigCanvas.width = container.clientWidth * ratio;
      sigCanvas.height = container.clientHeight * ratio;
      sigCanvas.getContext("2d").scale(ratio, ratio);
      signaturePad.clear();
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    // Clear signature button event
    document.getElementById('clear-signature').addEventListener('click', () => {
      signaturePad.clear();
    });

    // Gather form data
    function getFormData() {
      const data = {};
      data.name = document.getElementById("name").value;
      data.callSign = document.getElementById("call-sign").value;
      data.mailingAddress = document.getElementById("mailing-address").value;
      data.city = document.getElementById("city").value;
      data.state = document.getElementById("state").value;
      data.zip = document.getElementById("zip").value;
      data.email = document.getElementById("email").value;
      data.homePhone = document.getElementById("home-phone").value;
      data.workPhone = document.getElementById("work-phone").value;
      data.cellPhone = document.getElementById("cell-phone").value;
      data.licenseClass = document.getElementById("license-class").value;
      data.otherModes = document.getElementById("other-modes").value;
      data.date = document.getElementById("date").value;
      data.signatureProvided = signaturePad.isEmpty() ? "No" : "Yes";
      
      data.home_power = document.querySelector('input[name="home_power"]:checked') ?
                          document.querySelector('input[name="home_power"]:checked').value : "Not Answered";
      
      // SSB row
      data.ssb_hf = document.querySelector('input[name="ssb_hf"]').checked ? "Yes" : "No";
      data.ssb_6 = document.querySelector('input[name="ssb_6"]').checked ? "Yes" : "No";
      data.ssb_2 = document.querySelector('input[name="ssb_2"]').checked ? "Yes" : "No";
      data.ssb_222 = document.querySelector('input[name="ssb_222"]').checked ? "Yes" : "No";
      data.ssb_440 = document.querySelector('input[name="ssb_440"]').checked ? "Yes" : "No";
      data.ssb_others = document.querySelector('input[name="ssb_others"]').checked ? "Yes" : "No";
      // CW row
      data.cw_hf = document.querySelector('input[name="cw_hf"]').checked ? "Yes" : "No";
      data.cw_6 = document.querySelector('input[name="cw_6"]').checked ? "Yes" : "No";
      data.cw_2 = document.querySelector('input[name="cw_2"]').checked ? "Yes" : "No";
      data.cw_222 = document.querySelector('input[name="cw_222"]').checked ? "Yes" : "No";
      data.cw_440 = document.querySelector('input[name="cw_440"]').checked ? "Yes" : "No";
      data.cw_others = document.querySelector('input[name="cw_others"]').checked ? "Yes" : "No";
      // FM row
      data.fm_hf = document.querySelector('input[name="fm_hf"]').checked ? "Yes" : "No";
      data.fm_6 = document.querySelector('input[name="fm_6"]').checked ? "Yes" : "No";
      data.fm_2 = document.querySelector('input[name="fm_2"]').checked ? "Yes" : "No";
      data.fm_222 = document.querySelector('input[name="fm_222"]').checked ? "Yes" : "No";
      data.fm_440 = document.querySelector('input[name="fm_440"]').checked ? "Yes" : "No";
      data.fm_others = document.querySelector_

